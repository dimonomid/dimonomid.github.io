<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>Bot Terminal: Bot Terminal overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Bot Terminal
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Bot Terminal overview </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="overview"></a>
Bot Terminal overview</h1>
<p>Bot Terminal is a crossplatform utility that performs binary data exchange via serial port. It allows one to set up flexible rules about how to reply to different requests. So, it listens for data, parses it, and replies as necessary.</p>
<p>I developed this tool in order to reverse-engineer various binary protocols of car ECUs (Engine Control Unit). I connect some car diagnostic tool (tester) to the computer with Bot Terminal running, and it pretends to be an ECU. By replying different responses on the tester's requests, and by analyzing tester's behavior, I can make some assumptions about the protocol. That's easy.</p>
<p>I'm not sure whether it can be used for anything else. Anyway, it is published with the hope that it can.</p>
<p>A couple of useful links:</p>
<ul>
<li>User's documentation:<ul>
<li><a class="el" href="js_api.html">JavaScript host API</a></li>
</ul>
</li>
<li>Developer's documentation:<ul>
<li><a class="el" href="btcore.html">BTCore: implementation overview</a></li>
</ul>
</li>
</ul>
<p>Here is an overview of the workflow:</p>
<ul>
<li>New raw data comes from the serial port</li>
<li>Raw data is parsed into messages, by means of <code><a class="el" href="classBTCore_1_1Codec.html" title="Abstract codec that is used by BTCore::Project to decode messages (BTCore::DataMsg) from raw Rx data...">BTCore::Codec</a></code></li>
<li>For each received message, the sequence of the user-defined handlers is executed. Each handler may:<ul>
<li>Analyze input request message</li>
<li>Build and send response message (which is usually, again, encoded with <code><a class="el" href="classBTCore_1_1Codec.html" title="Abstract codec that is used by BTCore::Project to decode messages (BTCore::DataMsg) from raw Rx data...">BTCore::Codec</a></code>, but the handler is free to send raw data as well)</li>
<li>Stop further handlers execution (typically this is done when handler sends a response, but this is not mandatory)</li>
</ul>
</li>
</ul>
<p>Handlers are written in JavaScript. Typical handler may look as follows:</p>
<div class="fragment"><div class="line">(<span class="keyword">function</span>(inputMsg){</div>
<div class="line">    <span class="comment">//-- inputMsg contains the received request data.</span></div>
<div class="line">    <span class="comment">//   at the very least, it contains &quot;byteArr&quot; property</span></div>
<div class="line">    <span class="comment">//   with actual received message.</span></div>
<div class="line"></div>
<div class="line">    var inputArr = inputMsg.byteArr;</div>
<div class="line">    var handled = <span class="keyword">false</span>;</div>
<div class="line">    var outputArr = null;</div>
<div class="line"></div>
<div class="line">    <span class="comment">//-- check if we should handle this request</span></div>
<div class="line">    <span class="keywordflow">if</span> (inputArr.getU08(0) === 0x07){</div>
<div class="line">        <span class="comment">//-- yes, so, build the response</span></div>
<div class="line">        outputArr = factory.createByteArr();</div>
<div class="line">        outputArr</div>
<div class="line">            .putU08(0, 0xc7)</div>
<div class="line">            .putU16(2, 0x1234)</div>
<div class="line">            ;</div>
<div class="line">        handled = <span class="keyword">true</span>;</div>
<div class="line"></div>
<div class="line">        <span class="comment">//-- encode and send response via serial port</span></div>
<div class="line">        io.writeEncoded(outputArr);</div>
<div class="line">    };</div>
<div class="line"></div>
<div class="line">    <span class="comment">//-- if &quot;handled&quot; property in the returned object is true,</span></div>
<div class="line">    <span class="comment">//   the rest of handlers won&#39;t be executed</span></div>
<div class="line">    <span class="keywordflow">return</span> {</div>
<div class="line">        handled: handled</div>
<div class="line">    };</div>
<div class="line">})</div>
</div><!-- fragment --><p>The code is self-explanatory: we perform some arbitrary checks on received message, and generate and send the response if necessary.</p>
<p>Why JavaScript?</p>
<ul>
<li>Well, the first and main reason is that Qt has built-in first-class support of JavaScript: <a href="http://doc.qt.io/qt-5/qjsengine.html">QJSEngine</a>. Implementing support of other scripting language to the same degree of interconnection with Qt's meta object system would take <b>a lot</b> more effort.</li>
<li>Secondly, I know JavaScript very well and I even kind of like it. So, implementing handlers in JavaScript was a lot of fun.</li>
</ul>
<p>You don't have to have deep understanding of JavaScript in order to use the Bot Terminal. Here is a very brief overview of JavaScript that you should know: js_overview; and here is a host-specific API that you can use in handlers: <a class="el" href="js_api.html">JavaScript host API</a>.</p>
<p>Just in case you're willing to actually learn JavaScript (for whatever reason), here's a couple of books that I personally recommend:</p>
<ul>
<li><a href="http://www.amazon.com/JavaScript-Good-Parts-Douglas-Crockford/dp/0596517742">JavaScript: The Good Parts</a> by Douglas Crockford. It focuses on a subset of JavaScript (a good subset), it teaches you very useful patterns, and it is very concise: lots of material in less than 200 pages. Great read.</li>
<li><a href="http://www.amazon.com/JavaScript-Definitive-Guide-Activate-Guides/dp/0596805527">JavaScript: The Definitive Guide</a> by David Flanagan. It is much larger (1000+ pages), and it explains each and every detail of JavaScript. Great for getting deep understanding of the language.</li>
</ul>
<p>But, again, if the only JavaScript application you have is to use Bot Terminal, then you probably have something better to do rather than spending your valuable time on diving that deeply into JavaScript. Just read my brief overview.</p>
<p>And again, in any case, you need to know host-specific API that is exposed to handlers: <a class="el" href="js_api.html">JavaScript host API</a>.</p>
<p>The graphics interface of the application looks like this:</p>
<div class="image">
<img src="bterm_large.png" alt="bterm_large.png"/>
</div>
<p>The GUI is actually very flexible: main window contains an application log, and a number of dock widgets, which can be moved around, shown docked or undocked, or hidden. For example, there are a couple of other dock widgets that are not shown at the screenshot above: the project settings (title and codec selection), and codec settings (which, of course, depend on codec). </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Aug 26 2015 20:34:22 for Bot Terminal by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
